!function(e){if(template.config("escape",!1),e.WhiteMask=function(){e("body").append('<div id="white-mask"></div>')},e.WhiteMaskClose=function(){e("#white-mask").fadeOut("fast",function(){e(this).remove()})},e.jsonP=function(t,i,a,n,o){a=e.extend({app_key:_global.app_key,access_token:_global.access_token},a),"nomask"!=o&&e.WhiteMask(),e.when(e.ajax({url:t,type:i,dataType:"jsonp",data:a})).done(function(t){"nomask"!=o&&e.WhiteMaskClose(),n(t)}).fail(function(){e.PopupTip("连接服务器失败",!1,"center")})},e.DefaultBanner=function(){new Swiper(".swiper-container",{pagination:".banner-ind",loop:!0,grabCursor:!0,paginationClickable:!0,autoplay:3e3})},e.NewMsg=function(){e.jsonP(_global.url.api+"message","get",{open_id:_global.member_info.open_id,act:"get_count"},function(t){if(0==t.ret){var i='<u class="new-msg"></u>';t.data.tx_fc+t.data.tx_td+t.data.tx_sms>0?e(".index-btm").size()&&e(".index-btm li.a1").append(i):e(".index-btm li.a1 u").remove(),e(".retailcenter .item-nav li.gain").size()&&e(".retailcenter .item-nav li.team").size()&&(1==t.data.tx_fc&&e(".retailcenter .item-nav li.gain").append(i),1==t.data.tx_td&&e(".retailcenter .item-nav li.team").append(i)),e(".retailcenter .extend .msg").size()&&t.data.tx_sms>0&&e(".retailcenter .extend .msg").append("<i></i>")}},"nomask")},e.BottomBtn=function(t){var i='<div class="index-btm"><ul class="clearfix"><li class="a1">';if(_global&&_global.member_info){var a=parseInt(_global.member_info.shop_status);switch(a){case-1:case 2:i+='<a href="/retail/apply"><i></i>成为分销商</a>';break;case 0:i+='<a href="/retail/state"><i></i>成为分销商</a>';break;case 1:i+='<a href="/retail/index_v2"><i></i>分销商中心</a>'}}else i+='<a href="javascript:void(0);"><i></i>分销商中心</a>';i+='</li><li class="a2"><a href="/"><i></i>小店首页</a></li><li class="a3"><a href="/order/list_v2"><i></i>我的订单</a></li></ul></div>',"undefined"!=typeof t&&(i=e(i).find("li").eq(t).addClass("hover").parents(".index-btm")),e('<div class="footer-blank"></div>').appendTo("body"),e(i).appendTo("body"),e.NewMsg()},e.TellFavMask=function(){var t="";_global.site_info.weixin_account&&(t=_global.site_info.weixin_account),t?e("body").append('<div id="toFav"><div class="gz-num">'+t+"</div></div>"):e("body").append('<div id="toFav"></div>'),e("#toFav").on("click",function(){e(this).fadeOut("fast",function(){e(this).remove()})})},e.Qrcode=function(){e("body").append('<div id="Qrcode"><img src="'+_global.url.qrcode+'"><h3>亲，马上保存二维码图片分享至朋友圈</h3><h3>让伙伴长按二维码即可进入小店哦</h3></div>'),e("#Qrcode").on("click",function(){e(this).fadeOut(function(){e(this).remove()})})},e.AddFoot=function(){var t='<footer><p><a style="color:#666;" href="/">小店首页</a><a style="color:#666;" class="focus-us" href="javascript:void(0);">关注我们</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzAwMzA1NzU4Ng==&mid=201683746&idx=1&sn=473cef4ffdf69de5049c7e41d92babcd&scene=1&from=singlemessage&isappinstalled=0#rd"><span class="color-orange">121店</span> · 分享创造价值</a></p></footer>';(e(".btm-bar").size()||e(".sub-bar").size())&&(t+='<div class="footer-blank"></div>'),e("#main").append(t),e("footer .focus-us").on("click",function(){e.TellFavMask()})},e.Share=function(t){WeixinApi.ready(function(i){var a=t,n={ready:function(){e.WhiteMask()},cancel:function(){e.WhiteMaskClose()},fail:function(){e.WhiteMaskClose()},confirm:function(){e.WhiteMaskClose()},all:function(){e.WhiteMaskClose()}};i.shareToFriend(a,n),i.shareToTimeline(a,n),i.shareToWeibo(a,n)})},WeixinApi.ready(function(e){e.showOptionMenu()}),!e("#main").hasClass("goods-page")){var t=_global.url.site_url;_global.source_info&&_global.source_info.id&&(t+="shop_id/"+_global.source_info.id),e.Share({imgUrl:_global.site_info.logo_file,link:t,desc:_global.site_info.intro,title:_global.site_info.name})}e.getCityData=function(t){e.ajax({url:"/assets/js/common/cityData.min.json",dataType:"json",success:function(e){t(e)}})},e.showCart=function(){e.ajax({url:"/api/cart_is_exist_goods",type:"post",dataType:"json",data:{open_id:_global.member_info.open_id}}).done(function(t){if(0==t.ret){var i='<a href="/cart" id="cart-icon"></a>';e("body").append(i),(e(".index-btm").size()||e(".btm-bar").size())&&e("#cart-icon").css({bottom:"55px"})}})}}(jQuery);